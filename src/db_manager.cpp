////////////////////////////////////////////////////////////////////////////////
//
// Includes
//
#include "db_manager.h"
#include "db_storagesdata.h"
#include "db_customersdata.h"
#include "db_transactionsdata.h"

// Qt includes

////////////////////////////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////////////////////
namespace fm {
////////////////////////////////////////////////////////////////////////////////
namespace db {
////////////////////////////////////////////////////////////////////////////////


////////////////////////////////////////////////////////////////////////////////
//
// class CDBManager
//

// Interface Methodes
void CDBManager::Initialize(QString const& strDBFilePath)
{
	m_pDBConnectionStarter->StartConnection(strDBFilePath);

	SetDBComponent(std::shared_ptr<IDBComponent>(new CStoragesData()), "StoragesData", true);
	SetDBComponent(std::shared_ptr<IDBComponent>(new CCustomersData()), "CustomersData", true);
	SetDBComponent(std::shared_ptr<IDBComponent>(new CTransactionsData()), "TransactionsData", true);
}

// Helper Functions
bool CDBManager::SetDBComponent(std::shared_ptr<IDBComponent> pDBComponent, QString const& strComponentName, bool bInitialize)
{
	if (pDBComponent == nullptr || strComponentName == "")
		return false;

	if (bInitialize)
		pDBComponent->Initialize();

	m_mapStringToComponent.emplace(strComponentName, pDBComponent);

	return true;
}

////////////////////////////////////////////////////////////////////////////////


////////////////////////////////////////////////////////////////////////////////
} // namespace db
////////////////////////////////////////////////////////////////////////////////
} // namespace fm
////////////////////////////////////////////////////////////////////////////////